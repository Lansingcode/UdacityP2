install.packages('GGally')
install.packages('memise')
install.packages('memise')
install.packages('scales')
install.packages('memisc')
install.packages('memisc')
install.packages('installr')
require(installr)
install.packages('installr')
install.packages('memisc')
install.packages('rpart')
install.packages('rpart.plot')
ggplot(aes(x=quality_factor,y=fixed.acidity),data=winedata)+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('非挥发性酸 vs. 品质')
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message=FALSE)
# Load all of the packages that you end up using
# in your analysis in this code chunk.
# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.
library(ggplot2)
library(GGally)
library(scales)
#library(memisc)
# Load the Data
winedata=read.csv('wineQualityReds.csv')
# winedata=read.csv('wineQualityWhites.csv')
library(ggplot2)
winedata$quality_factor=factor(winedata$quality)
winedata$acidity=with(data=winedata,fixed.acidity+volatile.acidity+citric.acid)
qplot(data=winedata,x=quality)
#不易挥发性酸
qplot(data=winedata,x=fixed.acidity,binwidth=0.4)+
facet_wrap(~quality)
#易挥发性酸
qplot(data=winedata,x=volatile.acidity,binwidth=0.04)+
facet_wrap(~quality)
#柠檬酸
qplot(data=winedata,x=citric.acid,binwidth=0.04)+
facet_wrap(~quality)
#剩余糖分
qplot(data=winedata,x=residual.sugar,binwidth=0.2)+
facet_wrap(~quality)
#氯化物
qplot(data=winedata,x=chlorides,binwidth=0.02)+
scale_x_log10()+
facet_wrap(~quality)
#单体硫
qplot(data=winedata,x=free.sulfur.dioxide,binwidth=2)+
facet_wrap(~quality)
#总硫量
qplot(data=winedata,x=total.sulfur.dioxide,binwidth=5)+
xlim(0,165)+
facet_wrap(~quality)
#密度
qplot(data=winedata,x=density,binwidth=0.0005)+
facet_wrap(~quality)
#pH值
qplot(data=winedata,x=pH,binwidth=0.05)+
facet_wrap(~quality)
#硫酸盐
qplot(data=winedata,x=sulphates,binwidth=0.02)+
xlim(0.3,1.5)+
facet_wrap(~quality)
#酒精度
qplot(data=winedata,x=alcohol,binwidth=0.2)+
facet_wrap(~quality)
#酸总量
qplot(data=winedata,x=acidity,binwidth=0.5)+
facet_wrap(~quality)
quality_boxplot<-function(x,y,method='boxplot'){
if(method=='boxplot'){
qplot(x,y,geom=method)
}
}
p_<-GGally::print_if_interactive
wine_plot<-wrap(ggpairs,shape=I('.'),outlier.shape=I('.'))
wine_plot1<-wine_plot(winedata,mapping = NULL)
p_(wine_plot1)
ggplot(aes(x=quality_factor,y=fixed.acidity),data=winedata)+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('非挥发性酸 vs. 品质')
ggplot(aes(x=quality_factor,y=fixed.acidity),data=winedata)+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=fixed.acidity),data=winedata)+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('非挥发性酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=total.sulfur.dioxide),data=winedata)+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('二氧化硫总量 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=total.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('二氧化硫总量 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=fixed.acidity),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('非挥发性酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=fixed.acidity),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_x_sqrt()+
ggtitle('非挥发性酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=fixed.acidity),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('非挥发性酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=fixed.acidity),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('非挥发性酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=volatile.acidity),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('挥发性酸 vs. 品质')
ggplot(aes(x=quality_factor,y=volatile.acidity),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('挥发性酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=citric.acid),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('柠檬酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=residual.sugar),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('剩余糖 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=residual.sugar),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('剩余糖 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=residual.sugar),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('剩余糖 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=chlorides),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('氯化物 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality,y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_x_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
winedata$quality*winedata$quality
ggplot(aes(x=factor(quality*quality),y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide*free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=factor(quality-5),y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=factor(quality-5),y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=factor(quality-5),y=free.sulfur.dioxide-60),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
winedata$free.sulfur.dioxide
winedata$free.sulfur.dioxide-60
ggplot(aes(x=factor(quality-5),y=free.sulfur.dioxide-30),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=factor(quality-5),y=free.sulfur.dioxide-10),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=factor(quality-5),y=free.sulfur.dioxide-20),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide-20),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide-10),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=free.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('游离二氧化硫 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=total.sulfur.dioxide),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
scale_y_sqrt()+
ggtitle('二氧化硫总量 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=density),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('密度 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=density*density),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('密度 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=pH),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('pH vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=pH*pH),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('pH vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=pH),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('pH vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=pH*pH),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('pH vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=pH*pH),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('pH vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=sulphates),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('硫酸铵 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=alcohol),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.5)+
geom_boxplot(alpha=0.5)+
ggtitle('酒精度 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=alcohol+alcohol),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.5)+
geom_boxplot(alpha=0.5)+
ggtitle('酒精度 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=alcohol*alcohol),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.5)+
geom_boxplot(alpha=0.5)+
ggtitle('酒精度 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(aes(x=quality_factor,y=alcohol),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.5)+
geom_boxplot(alpha=0.5)+
ggtitle('酒精度 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(data=winedata,aes(x=fixed.acidity,y=density,color=quality_factor))+
geom_point(alpha = 0.9, size = 2, position = 'jitter')
ggplot(data=winedata,aes(x=fixed.acidity,y=density,color=quality_factor))+
geom_point(alpha = 0.9, size = 2, position = 'jitter')+
geom_smooth()
ggplot(data=subset(winedata,total.sulfur.dioxide<200),
aes(x=fixed.acidity,y=density,color=quality_factor))+
geom_point(alpha = 0.9, size = 2, position = 'jitter')+
geom_smooth(method = 'lm')
ggplot(data = subset(winedata,total.sulfur.dioxide<250),
aes(x=residual.sugar,y=total.sulfur.dioxide,color=quality_factor))+
geom_point()
ggplot(data = subset(winedata,total.sulfur.dioxide<250),
aes(x=acidity,y=total.sulfur.dioxide,color=quality_factor))+
geom_point()
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=alcohol,y=density,color=quality_factor))+
geom_point()
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=alcohol,y=density,color=quality_factor))+
geom_point()+
geom_smooth()
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=alcohol,y=density,color=quality_factor))+
geom_point()+
geom_smooth(method = 'lm')
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=alcohol,y=density,color=quality_factor))+
geom_point()+
geom_smooth(method = 'lm')+
ggtitle('density vs. alcohol vs. quality')
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=acidity,y=total.sulfur.dioxide,color=quality_factor))+
geom_point()
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=acidity,y=total.sulfur.dioxide,color=quality_factor))+
geom_point()+
geom_smooth()
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=acidity,y=total.sulfur.dioxide,color=quality_factor))+
geom_point()+
geom_smooth(method = 'lm')
# fixed.acidity vs. density vs. quality
ggplot(data=subset(winedata,total.sulfur.dioxide<200),
aes(x=fixed.acidity,y=density,color=quality_factor))+
geom_point(alpha = 0.9, size = 2, position = 'jitter')+
geom_smooth(method = 'lm')+
ggtitle('fixed.acidity vs. density vs. quality')
# density vs. alcohol vs. quality
ggplot(data = subset(winedata,total.sulfur.dioxide<200),
aes(x=alcohol,y=density,color=quality_factor))+
geom_point()+
geom_smooth(method = 'lm')+
ggtitle('density vs. alcohol vs. quality')
# fixed.acidity vs. density vs. quality
ggplot(data=subset(winedata,total.sulfur.dioxide<200),
aes(x=fixed.acidity,y=density*density,color=quality_factor))+
geom_point(alpha = 0.9, size = 2, position = 'jitter')+
geom_smooth(method = 'lm')+
ggtitle('fixed.acidity vs. density vs. quality')
qplot(data=winedata,x=quality)
ggplot(aes(x=quality_factor,y=citric.acid),data=subset(winedata,total.sulfur.dioxide<200))+
geom_jitter(alpha=0.3)+
geom_boxplot(alpha=0.5)+
ggtitle('柠檬酸 vs. 品质')+
theme(text=element_text(family="STKaiti",size=14))
ggplot(data=subset(winedata,total.sulfur.dioxide<200),
aes(x=fixed.acidity,y=density*density,color=quality_factor))+
geom_point(alpha = 0.9, size = 2, position = 'jitter')+
geom_smooth(method = 'lm')+
ggtitle('fixed.acidity vs. density vs. quality')
